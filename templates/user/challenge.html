{% include'user/header.html' %}
<style>
    ::-webkit-scrollbar {
        /*隐藏滚轮*/
        /*仅限于支持css3的浏览器*/
        display: none;
    }
    .ctf_card{
        border: 0.3rem solid #005cbf;
        background-color:#0d1927;
        color: #ffffff;
        font-size: .9rem;
    }
    .ctf-group-card-x{
        min-height: 12rem;
        max-height: 12rem;

    }
    .ctf-card-score{
        color: #4ec3ff;
        float: right;
        font-size: 20px;
    }
    .card-userinfo{
        border: 0.3rem solid #2c3e50;
        background-color: #0d1927;
        color: white;
        font-size: .9rem;
    }
    .card-competition-notice{
       border: 0.3rem solid #2c3e50;
        background-color: #0d1927;
        color: white;
        font-size: .9rem;
    }
    .card-competition-status{
        border: 0.3rem solid #2c3e50;
        background-color: #0d1927;
        color: white;
        font-size: .5rem;
    }
    .modal_content-ctf{
        background-color: rgba(13,25,39,0.99);
        color: white;
    }
    .ctf-modal_card{
         border: none;
    }
    .ctf_time{
        background-color: rgba(13,25,39,0.95);
    }
    .ctf-list-group-item{
        background-color: rgba(13,25,39,0.95);
        color: white
    }
    .font_Size{
            font-size: 0.9rem;
        }
    .ctf-modal_card-body{
        background-color: rgb(39,72,89);
        border-color: rgb(39,72,89);
    }
    .table td{
        padding: .2rem;
    }
    .card-competition-status-x{
        min-height: 12rem;
        max-height: 12rem;
        overflow-y:auto;
    }
    .card-competition-notice-x{
        overflow-y:auto;
        min-height: 12rem;
        max-height: 12rem;
        width: 100%;
    }
    .card-body{
        {#padding: .3rem;#}
        padding-bottom: .1rem;
        padding-top: .1rem;
    }
    .list-group-item-dark.list-group-item-action.active{
        background-color:rgba(13,25,39,0.95);
    }
</style>
<link rel="stylesheet" href="/static/css/user/challenges.css">
<div class="container-fluid">
    <br>
    <div class="row">
        <div class="col-md-3">
            <div class="card card-userinfo">
                <div class="card-header text-info">比赛信息</div>
                <div class="card-body">
                    <div class="row ctf-group-card-x">
                        <div class="col-md-12">战队名：<span class="text-info">{{ groupInfo[1] }}</span></div>
                        <div class="col-md-12">队员名：<span class="text-info">{{ username }}</span></div>
                        <div class="col-md-12">队伍简介：<span class="text-info">{{ groupInfo[3] }}</span></div>
                        <div class="col-md-12">战队排名：<span id="rank_num" class="text-info">{{ rank }}</span></div>
                        <div class="col-md-12">解题数量：<span id="track_sum" class="text-info">{{ Challenge_Count }}</span></div>
                        <div class="col-md-12">得分： <span id="sum_score" class="text-info">{{ sum_score }}</span></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
              <div class="card card-competition-notice">
                  <div class="card-header text-info">比赛公告</div>
                  <div class="card-body">
                      <div class="row card-competition-notice-x" >
                         <div class="col-md-12" >

                                 <ol>{#公告栏#}
                                     {% for i in userNotice %}
                                        <li>{{ i[1] }}</li>
                                     {% endfor %}
                                 </ol>

                         </div>
                      </div>
                  </div>
              </div>
        </div>
        <div class="col-md-3">
            <div class="card card-competition-status">
                <div class="card-header text-info">解题动态</div>
                <div class="card-body" style="">
                    <div class="card-competition-status-x">
                    {% if competition_StatusCode==1 %}
                        <table class="table table-borderless" id="challenge_list">
                        {% set num = ctf_history_table|length %}
                        {% for i in range(num-1,-1,-1) %}
                            <tr>
                                <td style="width: 30%" class="text-primary">{{ctf_history_table[i][0] }}战队</td>
                                <td style="width: 20%" class="text-danger">攻破了</td>
                                <td style="width: 30%" class="text-primary">{{ ctf_history_table[i][1] }}</td>
                                <td style="width: 20%" class="text-info">{{ ctf_history_table[i][3] }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                    {% endif %}
                    </div>

                </div>
            </div>
        </div>
    </div>
    <br>
{% if competition_StatusCode==1 %}
    <div class="row" style="min-height: 30rem;">
        <div class="col-md-2 col-sm-12">
             <div class="list-group" style="border: 0.2rem solid #1c2b36">
                 <a href="#" class="list-group-item list-group-item-action list-group-item-dark ctf-list-group-item" disabled  data-toggle="pill">比赛题目</a>
             {% for i in UserTypeNum  %}
                 <a class="list-group-item list-group-item-action {% if i[0]==0 %}active{% endif %}" style="background-color: rgba(13,25,39,0.99);color: white" href="#{% if i[0]==0 %}Web{% elif i[0]==1 %}Misc{% elif i[0]==2 %}Crypto{% elif i[0]==3 %}Reverse{% elif i[0]==4 %}Pwn{% endif %}" data-toggle="pill">{% if i[0]==0 %}Web{% elif i[0]==1 %}Misc{% elif i[0]==2 %}Crypto{% elif i[0]==3 %}Reverse{% elif i[0]==4 %}Pwn{% endif %} <span class="badge badge-success">{{ i[1] }}</span></a>
                 {% endfor %}
             </div>
        </div>
        <div class="col-md-7 col-sm-12">
           <!-- 选项卡菜单-->
<!-- 选项卡面板 -->
            <div class="tab-content">
                <!--Web-->
                <div class="tab-pane fade show active" id="Web">
                    <div class="row">
                        {% if challengeResult %}
                            {% for i in challengeResult %}
                                {% if i[4]==0 %}
                                    <div class="col-md-3">
                                        <div class="card ctf_card">
                                            <div class="card-header ">
                                                <div class="card-group" style="float: left"><b>{{ i[1] }}</b></div>
                                                <div class="card-group ctf-card-score">{{ i[2] }}</div>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-12 text-success">
                                                        <span id="hsm{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span>支队伍答对
                                                    </div>
                                                </div>
                                                <p></p>
                                                <div class="col-md-12" id="button{{ i[0] }}">
                                                    {% if i[11] %}
                                                        <button class="btn btn-success btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">已解答</button>
                                                    {% else %}
                                                        <button class="btn btn-primary btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">挑战</button>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {#模态框#}
                                    <div class="modal fade modal_fix"  id="modal{{ i[0] }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
                                        <div class="modal-dialog">
                                            <div class="modal-content modal_content-ctf" >
                                                <div class="modal-header">
                                                    <h4 class="modal-title" id="myModalLabel">{{ i[1] }}</h4>
                                                    <button type="button" style="color: white" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                                </div>
                                                <div class="modal-body ">
                                                    <div class="row row-no-gutters font_Size ">
                                                        <div class="col-md-6">分值:<span class=" text-info">{{ i[2] }}</span></div>
                                                        <div class="col-md-6 col-md-auto" id="span{{ i[0] }}">
                                                            {% if i[11] != None %}
                                                                <span  class="text-success ">已解答</span>
                                                            {% else %}
                                                                <span style="color: red" class="">未解答</span>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                    <div class="row" style="font-size: 0.9rem">
                                                        <div class="col-md-12">答对人数：<span class="text-info " id="hsm2{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span></div>
                                                        <div class="col-md-12">提示：<span class="text-info">{{ i[3] }}</span></div>
                                                        {% if i[7]==1 %}
                                                            <div class="col-md-12">题目附件:<a class="" href="/download/{{ i[8] }}">附件1</a></div>
                                                        {% endif %}
                                                        {% if i[5]==1 %}
                                                        <div class="col-md-12">
                                                            <div class="card ctf-modal_card" style="width: 100%;">
                                                                <div class="card-body ctf-modal_card-body">
                                                                    <h5 class="card-title text-center">{{ i[6] }}</h5>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {% endif %}

                                                    </div>
                                                <p></p>
                                                    <div class="row" id="div{{ i[0] }}" style="font-size: 0.9rem">

                                                        {% if i[11] !=  None %}
                                                            <div class="col-md-12">

                                                                <a class="text-success">已解答，获得{{ i[2] }}分</a>
                                                            </div>
                                                        {% else %}
                                                            <div class="col-md-12">
                                                                <div class="input-group">
                                                                <input id="flag{{ i[0] }}" style="background-color: rgba(0,0,0,0);border-color: #005cbf" type="text" name="flag"  autocomplete="off" placeholder="flag.."  class="form-control">
                                                                    <a class="input-group-addon btn btn-success" onclick="postflag('{{ i[0] }}','flag{{ i[0] }}')">提交</a>
                                                                </div>
                                                            </div>
                                                        {% endif %}

                                                    </div>
                                                </div>
                                            </div><!-- /.modal-content -->
                                        </div>
                                    </div> <!-- /.modal -->
                                {% endif  %}
                            {% endfor %}
                        {% endif %}
                        {#模态框#}
                    </div>{# 结束row #}
                </div>
                <!--Misc-->
                <div class="tab-pane fade" id="Misc">
                    <div class="row">
                        {% if challengeResult %}
                            {% for i in challengeResult %}
                                {% if i[4]==1 %}
                                    <div class="col-md-3">
                                        <div class="card ctf_card">
                                            <div class="card-header ">
                                                <div class="card-group" style="float: left"><b>{{ i[1] }}</b></div>
                                                <div class="card-group ctf-card-score">{{ i[2] }}</div>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-12 text-success">
                                                        <span id="hsm{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span>支队伍答对
                                                    </div>
                                                </div>
                                                <p></p>
                                                <div class="col-md-12" id="button{{ i[0] }}">
                                                    {% if i[11] %}
                                                        <button class="btn btn-success btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">已解答</button>
                                                    {% else %}
                                                        <button class="btn btn-primary btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">挑战</button>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {#模态框#}
                                    <div class="modal fade modal_fix"  id="modal{{ i[0] }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
                                       <div class="modal-dialog">
                                            <div class="modal-content modal_content-ctf" >
                                                <div class="modal-header">
                                                    <h4 class="modal-title" id="myModalLabel">{{ i[1] }}</h4>
                                                    <button type="button" style="color: white" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                                </div>
                                                <div class="modal-body ">
                                                    <div class="row row-no-gutters font_Size ">
                                                        <div class="col-md-6">分值:<span class=" text-info">{{ i[2] }}</span></div>
                                                        <div class="col-md-6 col-md-auto" id="span{{ i[0] }}">
                                                            {% if i[11] != None %}
                                                                <span  class="text-success ">已解答</span>
                                                            {% else %}
                                                                <span style="color: red" class="">未解答</span>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                    <div class="row" style="font-size: 0.9rem">
                                                        <div class="col-md-12">答对人数：<span class="text-info " id="hsm2{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span></div>
                                                        <div class="col-md-12">提示：<span class="text-info">{{ i[3] }}</span></div>
                                                        {% if i[7]==1 %}
                                                            <div class="col-md-12">题目附件:<a class="" href="/download/{{ i[8] }}">附件1</a></div>
                                                        {% endif %}
                                                        {% if i[5]==1 %}
                                                        <div class="col-md-12">
                                                            <div class="card ctf-modal_card" style="width: 100%;">
                                                                <div class="card-body ctf-modal_card-body">
                                                                    <h5 class="card-title text-center">{{ i[6] }}</h5>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {% endif %}

                                                    </div>
                                                <p></p>
                                                    <div class="row" id="div{{ i[0] }}" style="font-size: 0.9rem">

                                                        {% if i[11] !=  None %}
                                                            <div class="col-md-12">

                                                                <a class="text-success">已解答，获得{{ i[2] }}分</a>
                                                            </div>
                                                        {% else %}
                                                            <div class="col-md-12">
                                                                <div class="input-group">
                                                                <input id="flag{{ i[0] }}" style="background-color: rgba(0,0,0,0);border-color: #005cbf" type="text" name="flag"  autocomplete="off" placeholder="flag.."  class="form-control">
                                                                    <a class="input-group-addon btn btn-success" onclick="postflag('{{ i[0] }}','flag{{ i[0] }}')">提交</a>
                                                                </div>
                                                            </div>
                                                        {% endif %}

                                                    </div>
                                                </div>
                                            </div><!-- /.modal-content -->
                                        </div>
                                    </div> <!-- /.modal -->
                                {% endif  %}
                            {% endfor %}
                        {% endif %}
                        {#模态框#}
                    </div>{# 结束row #}
                </div><!--end tab-pane-->


                <!--Crypto-->
                <div class="tab-pane fade" id="Crypto">
                    <div class="row">
                        {% if challengeResult %}
                            {% for i in challengeResult %}
                                {% if i[4]==2 %}
                                    <div class="col-md-3">
                                        <div class="card ctf_card">
                                            <div class="card-header ">
                                                <div class="card-group" style="float: left"><b>{{ i[1] }}</b></div>
                                                <div class="card-group ctf-card-score">{{ i[2] }}</div>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-12 text-success">
                                                        <span id="hsm{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span>支队伍答对
                                                    </div>
                                                </div>
                                                <p></p>
                                                <div class="col-md-12" id="button{{ i[0] }}">
                                                    {% if i[11] %}
                                                        <button class="btn btn-success btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">已解答</button>
                                                    {% else %}
                                                        <button class="btn btn-primary btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">挑战</button>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {#模态框#}
                                    <div class="modal fade modal_fix"  id="modal{{ i[0] }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
                                       <div class="modal-dialog">
                                            <div class="modal-content modal_content-ctf" >
                                                <div class="modal-header">
                                                    <h4 class="modal-title" id="myModalLabel">{{ i[1] }}</h4>
                                                    <button type="button" style="color: white" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                                </div>
                                                <div class="modal-body ">
                                                    <div class="row row-no-gutters font_Size ">
                                                        <div class="col-md-6">分值:<span class=" text-info">{{ i[2] }}</span></div>
                                                        <div class="col-md-6 col-md-auto" id="span{{ i[0] }}">
                                                            {% if i[11] != None %}
                                                                <span  class="text-success ">已解答</span>
                                                            {% else %}
                                                                <span style="color: red" class="">未解答</span>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                    <div class="row" style="font-size: 0.9rem">
                                                        <div class="col-md-12">答对人数：<span class="text-info " id="hsm2{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span></div>
                                                        <div class="col-md-12">提示：<span class="text-info">{{ i[3] }}</span></div>
                                                        {% if i[7]==1 %}
                                                            <div class="col-md-12">题目附件:<a class="" href="/download/{{ i[8] }}">附件1</a></div>
                                                        {% endif %}
                                                        {% if i[5]==1 %}
                                                        <div class="col-md-12">
                                                            <div class="card ctf-modal_card" style="width: 100%;">
                                                                <div class="card-body ctf-modal_card-body">
                                                                    <h5 class="card-title text-center">{{ i[6] }}</h5>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {% endif %}

                                                    </div>
                                                <p></p>
                                                    <div class="row" id="div{{ i[0] }}" style="font-size: 0.9rem">

                                                        {% if i[11] !=  None %}
                                                            <div class="col-md-12">

                                                                <a class="text-success">已解答，获得{{ i[2] }}分</a>
                                                            </div>
                                                        {% else %}
                                                            <div class="col-md-12">
                                                                <div class="input-group">
                                                                <input id="flag{{ i[0] }}" style="background-color: rgba(0,0,0,0);border-color: #005cbf" type="text" name="flag"  autocomplete="off" placeholder="flag.."  class="form-control">
                                                                    <a class="input-group-addon btn btn-success" onclick="postflag('{{ i[0] }}','flag{{ i[0] }}')">提交</a>
                                                                </div>
                                                            </div>
                                                        {% endif %}

                                                    </div>
                                                </div>
                                            </div><!-- /.modal-content -->
                                        </div>
                                    </div> <!-- /.modal -->
                                {% endif  %}
                            {% endfor %}
                        {% endif %}
                        {#模态框#}
                    </div>{# 结束row #}
                </div><!--end tab-pane-->
                <!--Reverse-->
                <div class="tab-pane fade" id="Reverse">
                    <div class="row">
                        {% if challengeResult %}
                            {% for i in challengeResult %}
                                {% if i[4]==3 %}
                                    <div class="col-md-3">
                                        <div class="card ctf_card">
                                            <div class="card-header">
                                                <div class="card-group" style="float: left"><b>{{ i[1] }}</b></div>
                                                <div class="card-group ctf-card-score">{{ i[2] }}</div>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-12 text-success">
                                                        <span id="hsm{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span>支队伍答对
                                                    </div>
                                                </div>
                                                <p></p>
                                                <div class="col-md-12" id="button{{ i[0] }}">
                                                    {% if i[11] %}
                                                        <button class="btn btn-success btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">已解答</button>
                                                    {% else %}
                                                        <button class="btn btn-primary btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">挑战</button>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {#模态框#}
                                    <div class="modal fade modal_fix"  id="modal{{ i[0] }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
                                       <div class="modal-dialog">
                                            <div class="modal-content modal_content-ctf" >
                                                <div class="modal-header">
                                                    <h4 class="modal-title" id="myModalLabel">{{ i[1] }}</h4>
                                                    <button type="button" style="color: white" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                                </div>
                                                <div class="modal-body ">
                                                    <div class="row row-no-gutters font_Size ">
                                                        <div class="col-md-6">分值:<span class=" text-info">{{ i[2] }}</span></div>
                                                        <div class="col-md-6 col-md-auto" id="span{{ i[0] }}">
                                                            {% if i[11] != None %}
                                                                <span  class="text-success ">已解答</span>
                                                            {% else %}
                                                                <span style="color: red" class="">未解答</span>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                    <div class="row" style="font-size: 0.9rem">
                                                        <div class="col-md-12">答对人数：<span class="text-info " id="hsm2{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span></div>
                                                        <div class="col-md-12">提示：<span class="text-info">{{ i[3] }}</span></div>
                                                        {% if i[7]==1 %}
                                                            <div class="col-md-12">题目附件:<a class="" href="/download/{{ i[8] }}">附件1</a></div>
                                                        {% endif %}
                                                        {% if i[5]==1 %}
                                                        <div class="col-md-12">
                                                            <div class="card ctf-modal_card" style="width: 100%;">
                                                                <div class="card-body ctf-modal_card-body">
                                                                    <h5 class="card-title text-center">{{ i[6] }}</h5>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {% endif %}

                                                    </div>
                                                <p></p>
                                                    <div class="row" id="div{{ i[0] }}" style="font-size: 0.9rem">

                                                        {% if i[11] !=  None %}
                                                            <div class="col-md-12">

                                                                <a class="text-success">已解答，获得{{ i[2] }}分</a>
                                                            </div>
                                                        {% else %}
                                                            <div class="col-md-12">
                                                                <div class="input-group">
                                                                <input id="flag{{ i[0] }}" style="background-color: rgba(0,0,0,0);border-color: #005cbf" type="text" name="flag"  autocomplete="off" placeholder="flag.."  class="form-control">
                                                                    <a class="input-group-addon btn btn-success" onclick="postflag('{{ i[0] }}','flag{{ i[0] }}')">提交</a>
                                                                </div>
                                                            </div>
                                                        {% endif %}

                                                    </div>
                                                </div>
                                            </div><!-- /.modal-content -->
                                        </div>
                                    </div> <!-- /.modal -->
                                {% endif  %}
                            {% endfor %}
                        {% endif %}
                        {#模态框#}
                    </div>{# 结束row #}
                </div><!--end tab-pane-->
                <!--Pwn-->
                <div class="tab-pane fade" id="Pwn">
                    <div class="row">
                        {% if challengeResult %}
                            {% for i in challengeResult %}
                                {% if i[4]==4 %}
                                    <div class="col-md-3">
                                        <div class="card ctf_card">
                                            <div class="card-header ">
                                                <div class="card-group" style="float: left"><b>{{ i[1] }}</b></div>
                                                <div class="card-group ctf-card-score">{{ i[2] }}</div>
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-12 text-success">
                                                        <span id="hsm{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span>支队伍答对
                                                    </div>
                                                </div>
                                                <p></p>
                                                <div class="col-md-12" id="button{{ i[0] }}">
                                                    {% if i[11] %}
                                                        <button class="btn btn-success btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">已解答</button>
                                                    {% else %}
                                                        <button class="btn btn-primary btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal{{ i[0] }}">挑战</button>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {#模态框#}
                                   <div class="modal fade modal_fix"  id="modal{{ i[0] }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
                                        <div class="modal-dialog">
                                            <div class="modal-content modal_content-ctf" >
                                                <div class="modal-header">
                                                    <h4 class="modal-title" id="myModalLabel">{{ i[1] }}</h4>
                                                    <button type="button" style="color: white" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                                </div>
                                                <div class="modal-body ">
                                                    <div class="row row-no-gutters font_Size ">
                                                        <div class="col-md-6">分值:<span class=" text-info">{{ i[2] }}</span></div>
                                                        <div class="col-md-6 col-md-auto" id="span{{ i[0] }}">
                                                            {% if i[11] != None %}
                                                                <span  class="text-success ">已解答</span>
                                                            {% else %}
                                                                <span style="color: red" class="">未解答</span>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                    <div class="row" style="font-size: 0.9rem">
                                                        <div class="col-md-12">答对人数：<span class="text-info " id="hsm2{{ i[0] }}">{% if i[10]== None %}0{% else %}{{ i[10] }}{% endif %}</span></div>
                                                        <div class="col-md-12">提示：<span class="text-info">{{ i[3] }}</span></div>
                                                        {% if i[7]==1 %}
                                                            <div class="col-md-12">题目附件:<a class="" href="/download/{{ i[8] }}">附件1</a></div>
                                                        {% endif %}
                                                        {% if i[5]==1 %}
                                                        <div class="col-md-12">
                                                            <div class="card ctf-modal_card" style="width: 100%;">
                                                                <div class="card-body ctf-modal_card-body">
                                                                    <h5 class="card-title text-center">{{ i[6] }}</h5>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {% endif %}

                                                    </div>
                                                <p></p>
                                                    <div class="row" id="div{{ i[0] }}" style="font-size: 0.9rem">

                                                        {% if i[11] !=  None %}
                                                            <div class="col-md-12">

                                                                <a class="text-success">已解答，获得{{ i[2] }}分</a>
                                                            </div>
                                                        {% else %}
                                                            <div class="col-md-12">
                                                                <div class="input-group">
                                                                <input id="flag{{ i[0] }}" style="background-color: rgba(0,0,0,0);border-color: #005cbf" type="text" name="flag"  autocomplete="off" placeholder="flag.."  class="form-control">
                                                                    <a class="input-group-addon btn btn-success" onclick="postflag('{{ i[0] }}','flag{{ i[0] }}')">提交</a>
                                                                </div>
                                                            </div>
                                                        {% endif %}

                                                    </div>
                                                </div>
                                            </div><!-- /.modal-content -->
                                        </div>
                                    </div> <!-- /.modal -->
                                {% endif  %}
                            {% endfor %}
                        {% endif %}
                        {#模态框#}
                    </div>{# 结束row #}
                </div><!--end tab-pane-->
            </div>
        </div>
        <div class="col-md-3 col-sm-12">
            <div class="row">
                <div class="col-md-12 ">
                    <div class="ctf_time time btn-group text-right ">
                        <button class="btn btn-lg text-info">
                            <span>距离比赛结束:</span>
                            <span id="t_d">00天</span>
                            <span id="t_h">00时</span>
                            <span id="t_m">00分</span>
                            <span id="t_s">00秒</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        setInterval(function() {
            const EndTime = new Date('{{ end_time }}');
            const NowTime = new Date();
            const t = EndTime.getTime() - NowTime.getTime();
            let d = 0;
            let h = 0;
            let m = 0;
            let s = 0;
            if (t >= 0) {
                d = Math.floor(t / 1000 / 60 / 60 / 24);
                h = Math.floor(t / 1000 / 60 / 60 % 24);
                m = Math.floor(t / 1000 / 60 % 60);
                s = Math.floor(t / 1000 % 60);
            }
            document.getElementById("t_d").innerHTML = d + "天";
            document.getElementById("t_h").innerHTML = h + "时";
            document.getElementById("t_m").innerHTML = m + "分";
            document.getElementById("t_s").innerHTML = s + "秒";
        }, 10);
    </script>

{% else %}
    <div class="row">
        <div class="col-md-12">
            <h1 class="title text-center text-primary">现在不是比赛时间！</h1>
            <p class="text-primary">开始时间:{{ competition_info[3] }}</p>
            <p class="text-primary">结束时间:{{ competition_info[4] }}</p>
        </div>
    </div>
{% endif %}
</div>

<script type="text/javascript">
    function postflag(ctf_id,id){
        const a = document.getElementById(id).value;
        $.ajax({
                url: "/checkCtfFlag",
                type: "post",
                data: {"flag": a,"ctf_id":ctf_id},
                success: function (result) {
                    if(result=='502'){
                        alert('flag值不能为空');
                    }
                    else {
                        if (result == "503") {
                        alert("回答错误");
                        }
                        else {
                            if(result == "0")
                            {
                                alert("系统异常");
                            }
                        }
                    }
                    },
             error:function () {
                alert("发送请求失败");
            }

            }
        )
    }

    $(document).ready(function () {
        function getCookie(name){
            var strcookie = document.cookie;//获取cookie字符串
            var arrcookie = strcookie.split("; ");//分割
            // 遍历匹配
            for ( var i = 0; i < arrcookie.length; i++) {
                var arr = arrcookie[i].split("=");
                if (arr[0] == name){
                    return arr[1];
                }
            }
            return "";
        }
        var url = location.href;
        var socket = io.connect(url);
        //申请加入这个队伍
        var token = getCookie("token");

        socket.emit("join_group", { "token":token});
        //加入后接收消息回调
        socket.on("group_message", (res) => {
                var button_res = $("#button"+res.challenge_id);
                button_res.empty();
                button_res.append('<button class="btn btn-success btn-lg btn-block" style="border-color: #696969" data-toggle="modal" data-target="#modal'+res.challenge_id+'">已解答</button>');
                var divxxx = $('#div'+res.challenge_id);
                divxxx.empty();
                divxxx.append('<div class="col-md-12"> <a class="text-success">已解答，获得'+res.score+'分</a></div>');
                var sum_score_var = $('#sum_score');
                sum_score = sum_score_var.text();
                sum_score_int = Number(sum_score)+Number(res.score);
                sum_score_var.text(sum_score_int.toString());
                var count_track_var = $('#track_sum');
                count_track = count_track_var.text();
                count_track_int = Number(count_track)+1;
                count_track_var.text(count_track_int.toString());
                var count_hsm_var = $('#hsm'+res.challenge_id);
                count_hsm = count_hsm_var.text();
                count_hsm_int = Number(count_hsm)+1;
                count_hsm_var.text(count_hsm_int.toString());
                var count_hsm2_var = $('#hsm2'+res.challenge_id);
                count_hsm2 = count_hsm2_var.text();
                count_hsm2_int = Number(count_hsm2)+1;
               count_hsm2_var.text(count_hsm2_int.toString());
               var spanxxx = $('#span'+res.challenge_id);
                spanxxx.empty();
                spanxxx.append('<span class="text-success">已解答</span>');
                /*更新排名*/
                var rank_num = $('#rank_num');
                rank_num.text(res.ranks.toString())
        })
        socket.on('challenge_list',function (res){
            var t = res;
            $('#challenge_list').prepend('<tr><td class="text-primary">'+t.name+'战队</td><td class="text-danger">攻破了</td><td class="text-primary">'+t.target+'</td><td class="text-info">'+t.date+'</td></tr>');
        })
        socket.on('timeout',function () {
            window.location.href='/logout';
        })
    })
</script>
{% include'user/footer.html' %}





