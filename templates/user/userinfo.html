{% include 'user/header.html' %}
<style>
    .rank-card{
        border: 0.3rem solid #2c3e57;
        background-color: rgba(0,0,0,0);
        color: white;
    }
    .user-col{
         height: 2rem;
    }
    .btn-ctf-group{
        background-color: rgba(0,0,0,0);
        border: 0.1rem solid #2c3e60;
    }
    .user-img{
        border: 0.4rem solid #2c3e77;
    }
    .change-img-btn{
        border-radius: .25rem;
        background: #0d1927;
        color: #005cbf;
        border: #0d1940;
    }
    #update_password{
        top: 26%;
    }


</style>
<div  class="container-fluid">
<div class="row">
    <br>
    </div>
    <div class="row">
        <div class="col-md-offset-1 col-md-1"></div>
        <div class="col-md-10">
            <div class="card rank-card">
                <div class="card-header">
                    <h3 class="card-title text-center text-primary">个人信息</h3>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12 text-center">
                                <img  src="https://www.hsm.cool/usr/uploads/2020/07/3375162998.jpeg" class="rounded-circle img-fluid user-img" alt="{{ username }}">
                        </div>
                        <div class="col-md-12">
                            <br>
                        </div>
                        <div class="col-md-12 text-center">
                            <button class="change-img-btn">更改头像</button>
                        </div>
                    </div>
                <hr style="border-bottom: .1rem solid #2c3e57">
                    <div class="row" style="font-size: 1.1rem">
                        <div class="col-md-4 text-center">
                           用户名：<span class="text-info">{{ username }}</span>
                        </div>
                        <div class="col-md-4 text-center user-col">
                           真实姓名：<span class="text-info">{% if userinfo[2] %}{{ userinfo[2] }}{% else %}未设置{% endif %}</span>
                        </div>
                        <div class="col-md-4 text-center user-col">
                           班级：<span class="text-info">{% if userinfo[7] %}{{ userinfo[7] }}{% else %}未设置{% endif %}</span>
                        </div>
                        <div class="col-md-4 text-center user-col">
                           ID：<span class="text-info">{% if userinfo[0] %}{{ userinfo[0] }}{% else %}未设置{% endif %}</span>
                        </div>
                        <div class="col-md-4 text-center user-col">
                           学号：<span class="text-info user-col">{% if userinfo[1] %}{{ userinfo[1] }}{% else %}未设置{% endif %}</span>
                        </div>
                        <div class="col-md-4 text-center user-col">
                           邮箱：<span class="text-info">{% if userinfo[5] %}{{ userinfo[5] }}{% else %}未设置{% endif %}</span>
                        </div>
                        <div class="col-md-4 text-center user-col">
                           电话：<span class="text-info">{% if userinfo[6] %}{{ userinfo[6] }}{% else %}未设置{% endif %}</span>
                        </div>
                        <div class="col-md-4 text-center user-col">
                           所属队伍：<span class="text-info">{% if usergroupinfo[1] %}{{ usergroupinfo[1] }}{% else %}未设置{% endif %}</span>
                        </div>
                    </div>
                <hr style="border-bottom: .1rem solid #2c3e57">
                <div class="row">
                    <div class="col-md-12 text-center"><h4 class="title text-primary">基本设置</h4></div>
                        <br>
                        <div class="col-md-12">
                            <div class="btn-group">
                                <button class="btn btn-info btn-ctf-group" data-toggle="modal" data-target="#update_info">信息修改</button>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary btn-ctf-group" data-toggle="modal" data-target="#update_password">修改密码</button>
                            </div>
                            <!-- 模态框 -->
                           <div class="modal fade" id="update_info">
                               <div class="modal-dialog">
                                   <div class="modal-content text-dark">

                                        <!-- 模态框头部 -->
                                        <div class="modal-header">
                                          <h4 class="modal-title">信息修改</h4>
                                          <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        </div>
                                        <!-- 模态框主体 -->
                                        <div class="modal-body" style="overflow: auto">
                                            <form action="/change_user_info" method="post">
                                                <div class="form-group">
                                                  <label for="username">用户名:</label>
                                                  <input type="text" class="form-control" id="username" name="name" value="{{ username }}">
                                                </div>
                                                <div class="form-group">
                                                  <label for="email">邮箱:</label>
                                                  <input type="email" class="form-control" id="email" name="email" value="{{ userinfo[5] }}">
                                                </div>
                                                <div class="form-group">
                                                  <label for="realname">真实姓名:</label>
                                                  <input type="text" class="form-control" id="realname" name="real_name" value="{{ userinfo[2] }}">
                                                </div>
                                                <div class="form-group">
                                                  <label for="jju_class">班级:</label>
                                                  <input type="text" class="form-control" id="jju_class" name="class_name" value="A1861">
                                                </div>
                                                <div class="form-group">
                                                  <label for="sid">学号:</label>
                                                  <input type="text" class="form-control" id="sid" name="user_id" value="{{ userinfo[1] }}">
                                                </div>
                                                <div class="form-group">
                                                  <label for="mobile">电话:</label>
                                                  <input type="text" class="form-control" id="mobile" name="mobile" value="{{ userinfo[6] }}">
                                                </div>
                                                <button type="submit" class="btn btn-primary">提交</button>
                                              </form>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                            <!--模态框结束-->

                            <!-- 模态框 -->
                           <div class="modal fade " id="update_password">
                               <div class="modal-dialog">
                                   <div class="modal-content text-dark">
                                        <!-- 模态框头部 -->
                                        <div class="modal-header">
                                          <h4 class="modal-title">修改密码</h4>
                                          <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        </div>
                                        <!-- 模态框主体 -->
                                        <div class="modal-body" style="overflow: auto">
                                            <form action="/update_user_passwd" method="post">
                                                <div class="form-group">
                                                  <label for="username">原密码:</label>
                                                  <input type="text" class="form-control" name="old_pwd"  placeholder="请设置登录密码">
                                                </div>
                                                <div class="form-group">
                                                  <label for="email">新密码:</label>
                                                  <input type="password" class="form-control" name="pwd" id="pwd" placeholder="请填写密码">
                                                </div>
                                                <div class="form-group">
                                                  <label for="email">确认密码:</label>
                                                  <input type="password" class="form-control" name="pwd" id="pwd1" placeholder="请再次填写密码"  onkeyup="validate()">
                                                </div>
                                                <div class="form-group" id="tishi"></div>
                                                <button type="submit" id="button" class="btn btn-primary">提交</button>
                                              </form>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                            <!--模态框结束-->


                        </div>
                    </div>
                <hr style="border-bottom: .1rem solid #2c3e57">
                    <div class="row">
                        <div class="col-md-12 text-center"><h3 class="title text-success">个人技能树</h3></div>
                        <div class="col-md-6" >
                             <div id="scorechart" style="width: 100%;height: 30rem;padding: 0rem"></div>
                        </div>
                        <div class="col-md-6" >
                             <div id="scorelist" style="width: 100%;height: 30rem;padding: 0rem"></div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="col-md-offset-1 col-md-1"></div>
    </div>
</div>

<script>
    // 验证确认密码
function validate() {
    var pwd1 = document.getElementById("pwd").value;
    var pwd2 = document.getElementById("pwd1").value;
<!-- 对比两次输入的密码 -->
    if(pwd1 == pwd2)
     {
         if(pwd1.toString().length<6){
             document.getElementById("tishi").innerHTML="<span class='text-danger'>密码长度必须大于或等于6字节</span>";
            document.getElementById("button").disabled = true;
         }
         else {
             document.getElementById("tishi").innerHTML="<span class='text-danger'></span>";
             document.getElementById("button").disabled = false;
         }
     }
    else {
        document.getElementById("tishi").innerHTML="<span class='text-danger'>两次密码不相同</span>";
        document.getElementById("button").disabled = true;
     }
}
</script>



<script type="text/javascript" src="/static/js/echarts.js"></script>
<script>
    var scorechart = echarts.init(document.getElementById('scorechart'))
    option =  {
        backgroundColor: 'rgba(15,37,73,0.05)',
        color: ['#ffffff', '#61BE67'],
        tooltip: {
          show: true // 弹层数据去掉
        },
        radar: {
          center: ['50%', '55%'], // 外圆的位置
          name: {
            textStyle: {
              color: '#fff',
              fontSize: 14,
              fontWeight: 400,
              fontFamily: 'PingFangSC-Regular,PingFang SC'
            }
          },
          // TODO:
          indicator: [
            {
              name: 'WEB',
              max: 100
            },
            {
              name: 'MISC',
              max: 100
            },
            {
              name: 'Crypto',
              max: 100
            },
            {
              name: 'Reverse',
              max: 100
            },
            {
              name: 'Pwn',
              max: 100
            }
          ],
          splitArea: {
            // 坐标轴在 grid 区域中的分隔区域，默认不显示。
            show: true,
            areaStyle: {
              // 分隔区域的样式设置。
              color: ['#1c2330'] // 分隔区域颜色。分隔区域会按数组中颜色的顺序依次循环设置颜色。默认是一个深浅的间隔色。
            }
          },
          axisLine: {
            // 指向外圈文本的分隔线样式
            lineStyle: {
              color: 'rgba(255,255,255,0.2)'
            }
          },
          splitLine: {
            lineStyle: {
              type: 'dashed',
              color: '#fff', // 分隔线颜色
              width: 1 // 分隔线线宽
            }
          }
        },
        series: [
          {
            type: 'radar',
            data: [
              {
                // TODO:
                value: [80, 80, 80, 60, 20],
                name: 'a',
                areaStyle: {
                  normal: {
                    color: 'rgba(76,155,254,0.5)'
                  }
                }
              },
              {
                // TODO:
                value: [40, 70, 20, 60, 20],
                name: 'b',
                areaStyle: {
                  normal: {
                    color: 'rgba(35,189,84,0.2)'
                  }
                }
              }
            ]
          }
        ]
      }
scorechart.setOption(option)




{#    这是scorelist#}
  var scorelistchart = echarts.init(document.getElementById('scorelist'))
option = {
    grid: {
        left: '5%',
        right: '5%',
        bottom: '5%',
        top: '10%',
        containLabel: true
    },
    tooltip: {
        trigger: 'axis',
        axisPointer: {
            type: 'none'
        },
        formatter: function(params) {
            return params[0].name + '<br/>' +
                "<span style='display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:rgba(36,207,233,0.9)'></span>" +
                params[0].seriesName + ' : ' + Number((params[0].value.toFixed(4) / 1).toFixed(2)).toLocaleString() + ' 题<br/>'
        }
    },
    backgroundColor: 'rgba(15,37,73,0.05)',
    xAxis: {
        show: false,
        type: 'value'
    },
    yAxis: [{
        type: 'category',
        inverse: true,
        axisLabel: {
            show: true,
            textStyle: {
                color: '#fff'
            },
        },
        splitLine: {
            show: false
        },
        axisTick: {
            show: false
        },
        axisLine: {
            show: false
        },
        data: ['WEB', 'MISC', 'Crypto', 'Reverse', 'Pwn']
    }, {
        type: 'category',
        inverse: true,
        axisTick: 'none',
        axisLine: 'none',
        show: true,
        axisLabel: {
            textStyle: {
                color: '#ffffff',
                fontSize: '12'
            },
            formatter: function(value) {
                if (value >= 1) {
                    return (value / 1).toLocaleString() + '题';
                } else {
                    return value.toLocaleString();
                }
            },
        },
        data: [50, 22, 10, 50, 1]
    }],
    series: [{
            name: '题量',
            type: 'bar',
            zlevel: 1,
            itemStyle: {
                normal: {
                    barBorderRadius: 30,
                    color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [{
                        offset: 0,
                        color: 'rgb(57,89,255,1)'
                    }, {
                        offset: 1,
                        color: 'rgb(46,200,207,1)'
                    }]),
                },
            },
            barWidth: 20,
            data: [150, 22, 10, 50, 1]
        },
        {
            name: '背景',
            type: 'bar',
            barWidth: 20,
            barGap: '-100%',
            data: [150, 50, 50, 50, 1],
            itemStyle: {
                normal: {
                    color: 'rgba(24,31,68,1)',
                    barBorderRadius: 30,
                }
            },
        },
    ]
};
    scorelistchart.setOption(option)

</script>
{% include 'user/footer.html' %}